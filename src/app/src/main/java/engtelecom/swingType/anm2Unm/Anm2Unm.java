/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JInternalFrame.java to edit this template
 */
package engtelecom.swingType.anm2Unm;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.nio.file.Path;
import java.nio.file.Paths;

import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.filechooser.FileNameExtensionFilter;

import engtelecom.config.ConfigAnm2Unm;

/**
 *
 * @author faber222
 */
public class Anm2Unm extends javax.swing.JInternalFrame {

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton fileAnm;

    private javax.swing.JButton fileUnm;

    private javax.swing.JButton jButtonStart;

    private javax.swing.JLabel jLabel1;

    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabelPercent;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JProgressBar jProgressBar;
    private String batchAnm;
    private String batchUnm;

    private String AnmFilePath;
    private String UnmFilePath;

    private boolean batchAnmIsSelected;
    private boolean batchUnmIsSelected;

    /**
     * Creates new form MigracaoAnm2Unm
     */
    public Anm2Unm() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        fileAnm = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        fileUnm = new javax.swing.JButton();
        jPanel3 = new javax.swing.JPanel();
        jProgressBar = new javax.swing.JProgressBar();
        jButtonStart = new javax.swing.JButton();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jLabelPercent = new javax.swing.JLabel();

        setClosable(true);
        setIconifiable(true);
        setTitle("MIGRACAO ANM PARA UNM");
        setToolTipText("");

        jPanel2.setBorder(
            javax.swing.BorderFactory.createTitledBorder("Dados")
        );

        fileAnm.setIcon(
            new javax.swing.ImageIcon(
                getClass().getResource("/icons/folder_add.png")
            )
        ); // NOI18N
        fileAnm.setText("File");
        fileAnm.addActionListener(
            new java.awt.event.ActionListener() {
                public void actionPerformed(
                    final java.awt.event.ActionEvent evt
                ) {
                    fileAnmActionPerformed(evt);
                }
            }
        );

        jLabel1.setText("IMPORTAR BKP ANM:");
        jLabel1.setToolTipText("BKP DO ANM POR SLOT");

        jLabel2.setText("IMPORTAR BATCH UNM:");
        jLabel2.setToolTipText("BATCH POR SLOT");

        fileUnm.setIcon(
            new javax.swing.ImageIcon(
                getClass().getResource("/icons/folder_add.png")
            )
        ); // NOI18N
        fileUnm.setText("File");
        fileUnm.addActionListener(
            new java.awt.event.ActionListener() {
                public void actionPerformed(
                    final java.awt.event.ActionEvent evt
                ) {
                    fileUnmActionPerformed(evt);
                }
            }
        );

        final javax.swing.GroupLayout jPanel2Layout =
            new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout
                .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(
                    jPanel2Layout
                        .createSequentialGroup()
                        .addContainerGap()
                        .addGroup(
                            jPanel2Layout
                                .createParallelGroup(
                                    javax.swing.GroupLayout.Alignment.LEADING
                                )
                                .addComponent(
                                    jLabel1,
                                    javax.swing.GroupLayout.PREFERRED_SIZE,
                                    139,
                                    javax.swing.GroupLayout.PREFERRED_SIZE
                                )
                                .addComponent(jLabel2)
                        )
                        .addGap(46, 46, 46)
                        .addGroup(
                            jPanel2Layout
                                .createParallelGroup(
                                    javax.swing.GroupLayout.Alignment.LEADING
                                )
                                .addComponent(
                                    fileUnm,
                                    javax.swing.GroupLayout.PREFERRED_SIZE,
                                    143,
                                    javax.swing.GroupLayout.PREFERRED_SIZE
                                )
                                .addComponent(
                                    fileAnm,
                                    javax.swing.GroupLayout.PREFERRED_SIZE,
                                    143,
                                    javax.swing.GroupLayout.PREFERRED_SIZE
                                )
                        )
                        .addContainerGap(
                            javax.swing.GroupLayout.DEFAULT_SIZE,
                            Short.MAX_VALUE
                        )
                )
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout
                .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(
                    jPanel2Layout
                        .createSequentialGroup()
                        .addGroup(
                            jPanel2Layout
                                .createParallelGroup(
                                    javax.swing.GroupLayout.Alignment.TRAILING
                                )
                                .addComponent(fileAnm)
                                .addComponent(jLabel1)
                        )
                        .addGap(32, 32, 32)
                        .addGroup(
                            jPanel2Layout
                                .createParallelGroup(
                                    javax.swing.GroupLayout.Alignment.BASELINE
                                )
                                .addComponent(fileUnm)
                                .addComponent(jLabel2)
                        )
                        .addContainerGap(
                            javax.swing.GroupLayout.DEFAULT_SIZE,
                            Short.MAX_VALUE
                        )
                )
        );

        jPanel3.setBorder(
            javax.swing.BorderFactory.createTitledBorder("Painel")
        );

        jProgressBar.setValue(50);

        jButtonStart.setIcon(
            new javax.swing.ImageIcon(
                getClass().getResource("/icons/control_play_blue.png")
            )
        ); // NOI18N
        jButtonStart.setText("START");
        jButtonStart.addActionListener(
            new java.awt.event.ActionListener() {
                public void actionPerformed(
                    final java.awt.event.ActionEvent evt
                ) {
                    try {
						jButtonStartActionPerformed(evt);
					} catch (final Exception e) {
						e.printStackTrace();
					}
                }
            }
        );

        jLabel3.setText("INICIAR:");

        jLabel4.setText("Progresso:");

        jLabelPercent.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabelPercent.setText("50%");

        final javax.swing.GroupLayout jPanel3Layout =
            new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout
                .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(
                    jPanel3Layout
                        .createSequentialGroup()
                        .addContainerGap()
                        .addGroup(
                            jPanel3Layout
                                .createParallelGroup(
                                    javax.swing.GroupLayout.Alignment.LEADING
                                )
                                .addGroup(
                                    jPanel3Layout
                                        .createSequentialGroup()
                                        .addComponent(jLabel3)
                                        .addPreferredGap(
                                            javax.swing.LayoutStyle.ComponentPlacement.RELATED,
                                            javax.swing.GroupLayout.DEFAULT_SIZE,
                                            Short.MAX_VALUE
                                        )
                                        .addComponent(jButtonStart)
                                )
                                .addGroup(
                                    jPanel3Layout
                                        .createSequentialGroup()
                                        .addGroup(
                                            jPanel3Layout
                                                .createParallelGroup(
                                                    javax.swing.GroupLayout.Alignment.LEADING,
                                                    false
                                                )
                                                .addGroup(
                                                    jPanel3Layout
                                                        .createSequentialGroup()
                                                        .addComponent(jLabel4)
                                                        .addPreferredGap(
                                                            javax.swing.LayoutStyle.ComponentPlacement.RELATED,
                                                            javax.swing.GroupLayout.DEFAULT_SIZE,
                                                            Short.MAX_VALUE
                                                        )
                                                        .addComponent(
                                                            jLabelPercent,
                                                            javax.swing.GroupLayout.PREFERRED_SIZE,
                                                            41,
                                                            javax.swing.GroupLayout.PREFERRED_SIZE
                                                        )
                                                )
                                                .addComponent(
                                                    jProgressBar,
                                                    javax.swing.GroupLayout.PREFERRED_SIZE,
                                                    249,
                                                    javax.swing.GroupLayout.PREFERRED_SIZE
                                                )
                                        )
                                        .addGap(0, 0, Short.MAX_VALUE)
                                )
                        )
                        .addContainerGap(
                            javax.swing.GroupLayout.DEFAULT_SIZE,
                            Short.MAX_VALUE
                        )
                )
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout
                .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(
                    javax.swing.GroupLayout.Alignment.TRAILING,
                    jPanel3Layout
                        .createSequentialGroup()
                        .addGroup(
                            jPanel3Layout
                                .createParallelGroup(
                                    javax.swing.GroupLayout.Alignment.BASELINE
                                )
                                .addComponent(jLabel3)
                                .addComponent(jButtonStart)
                        )
                        .addPreferredGap(
                            javax.swing.LayoutStyle.ComponentPlacement.UNRELATED
                        )
                        .addGroup(
                            jPanel3Layout
                                .createParallelGroup(
                                    javax.swing.GroupLayout.Alignment.BASELINE
                                )
                                .addComponent(jLabel4)
                                .addComponent(jLabelPercent)
                        )
                        .addPreferredGap(
                            javax.swing.LayoutStyle.ComponentPlacement.RELATED
                        )
                        .addComponent(
                            jProgressBar,
                            javax.swing.GroupLayout.PREFERRED_SIZE,
                            23,
                            javax.swing.GroupLayout.PREFERRED_SIZE
                        )
                        .addContainerGap(
                            javax.swing.GroupLayout.DEFAULT_SIZE,
                            Short.MAX_VALUE
                        )
                )
        );

        final javax.swing.GroupLayout jPanel1Layout =
            new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout
                .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(
                    jPanel1Layout
                        .createSequentialGroup()
                        .addContainerGap()
                        .addComponent(
                            jPanel2,
                            javax.swing.GroupLayout.PREFERRED_SIZE,
                            javax.swing.GroupLayout.DEFAULT_SIZE,
                            javax.swing.GroupLayout.PREFERRED_SIZE
                        )
                        .addGap(18, 18, 18)
                        .addComponent(
                            jPanel3,
                            javax.swing.GroupLayout.DEFAULT_SIZE,
                            javax.swing.GroupLayout.DEFAULT_SIZE,
                            Short.MAX_VALUE
                        )
                        .addContainerGap()
                )
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout
                .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(
                    javax.swing.GroupLayout.Alignment.TRAILING,
                    jPanel1Layout
                        .createSequentialGroup()
                        .addContainerGap(
                            javax.swing.GroupLayout.DEFAULT_SIZE,
                            Short.MAX_VALUE
                        )
                        .addGroup(
                            jPanel1Layout
                                .createParallelGroup(
                                    javax.swing.GroupLayout.Alignment.LEADING,
                                    false
                                )
                                .addComponent(
                                    jPanel3,
                                    javax.swing.GroupLayout.DEFAULT_SIZE,
                                    javax.swing.GroupLayout.DEFAULT_SIZE,
                                    Short.MAX_VALUE
                                )
                                .addComponent(
                                    jPanel2,
                                    javax.swing.GroupLayout.DEFAULT_SIZE,
                                    javax.swing.GroupLayout.DEFAULT_SIZE,
                                    Short.MAX_VALUE
                                )
                        )
                        .addGap(15, 15, 15)
                )
        );

        final javax.swing.GroupLayout layout = new javax.swing.GroupLayout(
            getContentPane()
        );
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout
                .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addComponent(
                    jPanel1,
                    javax.swing.GroupLayout.PREFERRED_SIZE,
                    javax.swing.GroupLayout.DEFAULT_SIZE,
                    javax.swing.GroupLayout.PREFERRED_SIZE
                )
        );
        layout.setVerticalGroup(
            layout
                .createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(
                    layout
                        .createSequentialGroup()
                        .addComponent(
                            jPanel1,
                            javax.swing.GroupLayout.PREFERRED_SIZE,
                            126,
                            Short.MAX_VALUE
                        )
                        .addContainerGap()
                )
        );

        pack();
    }

    private void fileAnmActionPerformed(final java.awt.event.ActionEvent evt) {
        final JFileChooser fileChooser = new JFileChooser();

        // Adiciona um filtro para aceitar apenas arquivos de texto e derivados
        final FileNameExtensionFilter filter = new FileNameExtensionFilter(
            "Arquivos de Texto",
            "txt",
            "csv",
            "xls",
            "xlsx"
        );
        fileChooser.setFileFilter(filter);
        // Exibe o seletor de arquivo e obtém a resposta do usuário
        final int returnValue = fileChooser.showOpenDialog(this);
        fileChooser.setDialogTitle("Selecione o arquivo:");
        fileChooser.setFileSelectionMode(JFileChooser.FILES_ONLY);

        // Verifica se o usuário escolheu um arquivo
        if (returnValue == JFileChooser.APPROVE_OPTION) {
            this.batchAnmIsSelected = true;
            // Obtém o arquivo selecionado
            final java.io.File selectedFile = fileChooser.getSelectedFile();
            System.out.println(
                "Arquivo selecionado: " + selectedFile.getAbsolutePath()
            );
            this.AnmFilePath = selectedFile.getAbsolutePath();
            // fileUnm.setText(selectedFile.getName());
            String fileName = selectedFile.getName();
            final int maxLength = 5; // Defina o número máximo de caracteres visíveis

            if (fileName.length() > maxLength) {
                fileName = fileName.substring(0, maxLength) + "..."; // Corta e adiciona "..."
            }

            fileAnm.setText(fileName);
            // previewText(this.AnmFilePath);
        } else {
            this.batchAnmIsSelected = false;
            JOptionPane.showMessageDialog(
                null,
                "Nenhum arquivo selecionado.",
                "Error!",
                JOptionPane.ERROR_MESSAGE,
                null
            );
            fileAnm.setText("File");
            // jTextAreaPreviewCode.setText("");
        }
    }

    private void fileUnmActionPerformed(final java.awt.event.ActionEvent evt) {
        final JFileChooser fileChooser = new JFileChooser();

        // Adiciona um filtro para aceitar apenas arquivos de texto e derivados
        final FileNameExtensionFilter filter = new FileNameExtensionFilter(
            "Arquivos de Texto",
            "txt",
            "csv",
            "xls",
            "xlsx"
        );
        fileChooser.setFileFilter(filter);
        // Exibe o seletor de arquivo e obtém a resposta do usuário
        final int returnValue = fileChooser.showOpenDialog(this);
        fileChooser.setDialogTitle("Selecione o arquivo:");
        fileChooser.setFileSelectionMode(JFileChooser.FILES_ONLY);

        // Verifica se o usuário escolheu um arquivo
        if (returnValue == JFileChooser.APPROVE_OPTION) {
            this.batchUnmIsSelected = true;
            // Obtém o arquivo selecionado
            final java.io.File selectedFile = fileChooser.getSelectedFile();
            System.out.println(
                "Arquivo selecionado: " + selectedFile.getAbsolutePath()
            );
            this.UnmFilePath = selectedFile.getAbsolutePath();
            // fileUnm.setText(selectedFile.getName());
            String fileName = selectedFile.getName();
            final int maxLength = 5; // Defina o número máximo de caracteres visíveis

            if (fileName.length() > maxLength) {
                fileName = fileName.substring(0, maxLength) + "..."; // Corta e adiciona "..."
            }

            fileUnm.setText(fileName);
            // previewText(this.UnmFilePath);
        } else {
            this.batchUnmIsSelected = false;
            JOptionPane.showMessageDialog(
                null,
                "Nenhum arquivo selecionado.",
                "Error!",
                JOptionPane.ERROR_MESSAGE,
                null
            );
            fileUnm.setText("File");
            // jTextAreaPreviewCode.setText("");
        }
    }

    private void jButtonStartActionPerformed(
        final java.awt.event.ActionEvent evt
    ) throws Exception {
        if (this.batchAnmIsSelected && this.batchUnmIsSelected) {
            final ConfigAnm2Unm configAnm2Unm = new ConfigAnm2Unm(Paths.get(this.AnmFilePath), Paths.get(this.UnmFilePath));
            configAnm2Unm.processar();
        } else {
            if (!this.batchAnmIsSelected) {
                JOptionPane.showMessageDialog(
                    null,
                    "Nenhum bkp do ANM selecionado!",
                    "Error!",
                    JOptionPane.ERROR_MESSAGE,
                    null
                );
            } else {
                JOptionPane.showMessageDialog(
                    null,
                    "Nenhum batch do UNM selecionado!",
                    "Error!",
                    JOptionPane.ERROR_MESSAGE,
                    null
                );
            }
        }
    }
}
